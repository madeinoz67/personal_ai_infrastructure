version: "1.0"
last_updated: 2026-01-10
feeds:
  - name: abuse.ch URLhaus
    description: Malicious URLs used for malware distribution
    url: https://urlhaus.abuse.ch/downloads/json_recent/
    category: malware
    format: json
    api_key_env: null
    update_frequency: hourly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - url
    added: 2026-01-10
    last_checked: null
  - name: abuse.ch MalwareBazaar
    description: Malware samples and hashes
    url: https://mb-api.abuse.ch/api/v1/
    category: malware
    format: json
    api_key_env: null
    update_frequency: hourly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - sha256
      - sha1
      - md5
    added: 2026-01-10
    last_checked: null
  - name: abuse.ch ThreatFox
    description: IOCs associated with malware
    url: https://threatfox-api.abuse.ch/api/v1/
    category: iocs
    format: json
    api_key_env: null
    update_frequency: hourly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - ip
      - domain
      - url
      - sha256
    added: 2026-01-10
    last_checked: null
  - name: abuse.ch Feodo Tracker
    description: Botnet C2 servers
    url: https://feodotracker.abuse.ch/downloads/ipblocklist_recommended.json
    category: c2
    format: json
    api_key_env: null
    update_frequency: hourly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - ip
    added: 2026-01-10
    last_checked: null
  - name: OpenPhish
    description: Phishing URLs
    url: https://openphish.com/feed.txt
    category: phishing
    format: txt
    api_key_env: null
    update_frequency: hourly
    enabled: true
    priority: 2
    tlp: clear
    ioc_types:
      - url
    added: 2026-01-10
    last_checked: null
  - name: PhishTank
    description: Verified phishing URLs
    url: http://data.phishtank.com/data/online-valid.json
    category: phishing
    format: json
    api_key_env: null
    update_frequency: hourly
    enabled: true
    priority: 2
    tlp: clear
    ioc_types:
      - url
    added: 2026-01-10
    last_checked: null
  - name: SANS ISC
    description: Internet Storm Center daily diary
    url: https://isc.sans.edu/api/threat/day/
    category: general
    format: xml
    api_key_env: null
    update_frequency: daily
    enabled: true
    priority: 2
    tlp: clear
    ioc_types:
      - ip
      - domain
    added: 2026-01-10
    last_checked: null
  - name: AlienVault OTX
    description: Open Threat Exchange pulses
    url: https://otx.alienvault.com/api/v1/pulses/subscribed
    category: general
    format: json
    api_key_env: PAI_CTI_OTX_API_KEY
    update_frequency: hourly
    enabled: false
    priority: 1
    tlp: green
    ioc_types:
      - ip
      - domain
      - url
      - sha256
      - md5
      - email
    added: 2026-01-10
    last_checked: null
    notes: Get API key from https://otx.alienvault.com/
  - name: VirusTotal
    description: File and URL reputation
    url: https://www.virustotal.com/api/v3/
    category: reputation
    format: json
    api_key_env: PAI_CTI_VIRUSTOTAL_API_KEY
    update_frequency: on_demand
    enabled: false
    priority: 1
    tlp: amber
    ioc_types:
      - ip
      - domain
      - url
      - sha256
      - sha1
      - md5
    rate_limit: 4/min
    added: 2026-01-10
    last_checked: null
    notes: Get API key from https://www.virustotal.com/gui/join-us
  - name: Shodan
    description: Internet infrastructure intelligence
    url: https://api.shodan.io/
    category: infrastructure
    format: json
    api_key_env: PAI_CTI_SHODAN_API_KEY
    update_frequency: on_demand
    enabled: false
    priority: 1
    tlp: amber
    ioc_types:
      - ip
    rate_limit: 1/sec
    added: 2026-01-10
    last_checked: null
    notes: Get API key from https://shodan.io/
  - name: CISA Alerts
    description: US-CERT alerts and advisories
    url: https://www.cisa.gov/uscert/ncas/alerts.xml
    category: government
    format: rss
    api_key_env: null
    update_frequency: daily
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - cve
      - ip
      - domain
      - sha256
    added: 2026-01-10
    last_checked: null

  # =====================================
  # Enrichment Services (on-demand lookups)
  # =====================================

  - name: URLScan.io
    description: URL scanning and analysis
    url: https://urlscan.io/api/v1/
    category: reputation
    format: json
    api_key_env: PAI_CTI_URLSCAN_API_KEY
    update_frequency: on_demand
    enabled: false
    priority: 2
    tlp: green
    ioc_types:
      - url
      - domain
    rate_limit: 60/min
    added: 2026-01-10
    last_checked: null
    notes: Get API key from https://urlscan.io/user/signup

  - name: AbuseIPDB
    description: IP address abuse reports and reputation
    url: https://api.abuseipdb.com/api/v2/
    category: reputation
    format: json
    api_key_env: PAI_CTI_ABUSEIPDB_API_KEY
    update_frequency: on_demand
    enabled: false
    priority: 1
    tlp: amber
    ioc_types:
      - ip
    rate_limit: 30/min
    daily_limit: 1000
    added: 2026-01-11
    last_checked: null
    notes: Get API key from https://www.abuseipdb.com/account/api

  - name: EmailRep.io
    description: Email address reputation and risk scoring
    url: https://emailrep.io/
    category: reputation
    format: json
    api_key_env: null
    update_frequency: on_demand
    enabled: true
    priority: 2
    tlp: green
    ioc_types:
      - email
    rate_limit: 10/min
    added: 2026-01-11
    last_checked: null
    notes: Free tier available without API key (rate limited)

  - name: Spamhaus Intelligence API
    description: Domain and IP spam/botnet reputation
    url: https://api.spamhaus.org/api/v1/
    category: reputation
    format: json
    api_key_env: PAI_CTI_SPAMHAUS_API_KEY
    update_frequency: on_demand
    enabled: false
    priority: 1
    tlp: amber
    ioc_types:
      - ip
      - domain
    added: 2026-01-11
    last_checked: null
    notes: Commercial API - see https://www.spamhaus.com/developer/sia/

  - name: NIST NVD
    description: National Vulnerability Database for CVE enrichment
    url: https://services.nvd.nist.gov/rest/json/cves/2.0
    category: vulnerability
    format: json
    api_key_env: PAI_CTI_NVD_API_KEY
    update_frequency: on_demand
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - cve
    rate_limit: 5/30sec
    added: 2026-01-11
    last_checked: null
    notes: API key optional but recommended - get from https://nvd.nist.gov/developers/request-an-api-key

  - name: Hybrid Analysis
    description: Malware sandbox analysis and behavioral reports
    url: https://www.hybrid-analysis.com/api/v2/
    category: malware
    format: json
    api_key_env: PAI_CTI_HYBRID_ANALYSIS_API_KEY
    update_frequency: on_demand
    enabled: false
    priority: 1
    tlp: amber
    ioc_types:
      - sha256
      - sha1
      - md5
    rate_limit: 5/min
    added: 2026-01-11
    last_checked: null
    notes: Free tier available - https://www.hybrid-analysis.com/apikeys/info

  # =====================================
  # Threat Intelligence Blogs (use Browser skill to fetch as markdown)
  # =====================================

  - name: Krebs on Security
    description: Brian Krebs' security news and investigation blog
    url: https://krebsonsecurity.com/
    category: blog
    format: markdown
    api_key_env: null
    update_frequency: daily
    enabled: true
    priority: 2
    tlp: clear
    ioc_types:
      - domain
      - ip
      - email
    added: 2026-01-10
    last_checked: null
    notes: Use Browser skill to fetch and parse

  - name: The DFIR Report
    description: Real intrusion case studies with detailed TTPs and IoCs
    url: https://thedfirreport.com/
    category: blog
    format: markdown
    api_key_env: null
    update_frequency: weekly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - ip
      - domain
      - sha256
      - url
    added: 2026-01-10
    last_checked: null
    notes: Excellent source for real-world TTPs and IoCs

  - name: Unit 42 (Palo Alto)
    description: Palo Alto Networks threat research blog
    url: https://unit42.paloaltonetworks.com/
    category: blog
    format: markdown
    api_key_env: null
    update_frequency: weekly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - ip
      - domain
      - sha256
      - url
    added: 2026-01-10
    last_checked: null
    notes: APT and malware research

  - name: Mandiant Blog
    description: Google Mandiant threat intelligence blog
    url: https://www.mandiant.com/resources/blog
    category: blog
    format: markdown
    api_key_env: null
    update_frequency: weekly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - ip
      - domain
      - sha256
    added: 2026-01-10
    last_checked: null
    notes: APT tracking and nation-state research

  - name: Securelist (Kaspersky)
    description: Kaspersky GReAT team threat research
    url: https://securelist.com/
    category: blog
    format: markdown
    api_key_env: null
    update_frequency: weekly
    enabled: true
    priority: 1
    tlp: clear
    ioc_types:
      - ip
      - domain
      - sha256
      - md5
    added: 2026-01-10
    last_checked: null
    notes: APT and malware analysis

  - name: BleepingComputer
    description: Technology and security news
    url: https://www.bleepingcomputer.com/
    category: blog
    format: markdown
    api_key_env: null
    update_frequency: daily
    enabled: true
    priority: 2
    tlp: clear
    ioc_types:
      - domain
      - ip
      - sha256
    added: 2026-01-10
    last_checked: null
    notes: Breaking security news and ransomware coverage

settings:
  default_update_frequency: hourly
  max_concurrent_fetches: 3
  request_timeout: 30
  retry_attempts: 3
  retry_delay: 5
  storage_path: $PAI_DIR/data/threat-intel/
  max_iocs_per_feed: 10000
  retention_days: 90
  notify_on_critical: true
  notify_on_high: true
  notification_channels:
    - knowledge_graph

  # =====================================
  # Enhanced Caching Configuration
  # =====================================
  cache:
    enabled: true
    backend: file  # Options: file, redis
    default_ttl: 3600  # 1 hour default

    # TTL by IOC type (in seconds)
    # IPs change faster than domains, hashes are immutable
    ttl_by_ioc_type:
      ip: 3600        # 1 hour - IPs can change ownership quickly
      domain: 14400   # 4 hours - domains more stable
      url: 3600       # 1 hour - URLs can be taken down
      sha256: 86400   # 24 hours - hashes are immutable
      sha1: 86400     # 24 hours
      md5: 86400      # 24 hours
      email: 14400    # 4 hours
      cve: 86400      # 24 hours - CVE data updates slowly

    # TTL by source (overrides ioc_type when specified)
    ttl_by_source:
      virustotal: 14400     # 4 hours (strict rate limits)
      abuseipdb: 3600       # 1 hour
      otx: 7200             # 2 hours
      urlhaus: 1800         # 30 min (frequently updated)
      nvd: 86400            # 24 hours (slow updates)
      emailrep: 14400       # 4 hours

    max_cache_size_mb: 500
    compression: true
    cleanup_interval: 3600  # Clean expired entries hourly

  # =====================================
  # Rate Limit Management
  # =====================================
  rate_limiting:
    enabled: true

    # Global rate limit tracker
    tracking_backend: file  # Options: file, redis

    # Per-service configuration (overrides feed-level rate_limit)
    services:
      virustotal:
        requests_per_minute: 4
        daily_limit: 500
        monthly_limit: 15500
        backoff_strategy: exponential
        max_backoff_seconds: 300

      abuseipdb:
        requests_per_minute: 30
        daily_limit: 1000
        backoff_strategy: linear
        max_backoff_seconds: 60

      shodan:
        requests_per_second: 1
        backoff_strategy: exponential
        max_backoff_seconds: 120

      otx:
        requests_per_second: 10
        backoff_strategy: linear
        max_backoff_seconds: 30

      nvd:
        requests_per_30sec: 5
        backoff_strategy: exponential
        max_backoff_seconds: 60

      urlscan:
        requests_per_minute: 60
        daily_limit: 1000
        backoff_strategy: linear
        max_backoff_seconds: 60

      emailrep:
        requests_per_minute: 10
        backoff_strategy: linear
        max_backoff_seconds: 60

      hybrid_analysis:
        requests_per_minute: 5
        backoff_strategy: exponential
        max_backoff_seconds: 120

      spamhaus:
        requests_per_minute: 10
        backoff_strategy: linear
        max_backoff_seconds: 60

    # Request queue settings
    queue:
      enabled: true
      max_queued_requests: 100
      priority_levels:
        critical: 1    # Process immediately
        high: 2        # Next in queue
        normal: 3      # Standard priority
        low: 4         # Background enrichment

    # Alert thresholds
    alerts:
      warn_at_percent: 80     # Warn when 80% of limit used
      critical_at_percent: 95 # Critical when 95% used

categories:
  - name: malware
    description: Malware samples and distribution
    color: red
  - name: phishing
    description: Phishing campaigns and URLs
    color: orange
  - name: c2
    description: Command and control infrastructure
    color: red
  - name: iocs
    description: General indicators of compromise
    color: yellow
  - name: reputation
    description: Reputation lookup services
    color: blue
  - name: infrastructure
    description: Network infrastructure intelligence
    color: purple
  - name: government
    description: Government and ISAC sources
    color: green
  - name: general
    description: General threat intelligence
    color: gray
  - name: vulnerability
    description: CVE and vulnerability intelligence
    color: orange
  - name: blog
    description: Threat intelligence blogs and research
    color: blue
